import Foundation

// swiftlint:disable all

public extension Pamphlet.Private.Figurehead.Utility {
    static func DefinesJs() -> String {
    #if DEBUG
        let fileOnDiskPath = "/Volumes/Development/Development/chimerasw3/PicaroonTemplate/Resources/private/figurehead/utility/defines.js"
        if let contents = try? String(contentsOf:URL(fileURLWithPath: fileOnDiskPath)) {
            if contents.hasPrefix("#define PAMPHLET_PREPROCESSOR") {
                do {
                    let task = Process()
                    task.executableURL = URL(fileURLWithPath: "/usr/local/bin/pamphlet")
                    task.arguments = ["preprocess", fileOnDiskPath]
                    let outputPipe = Pipe()
                    task.standardOutput = outputPipe
                    try task.run()
                    let outputData = outputPipe.fileHandleForReading.readDataToEndOfFile()
                    let output = String(decoding: outputData, as: UTF8.self)
                    return output
                } catch {
                    return "Failed to use /usr/local/bin/pamphlet to preprocess the requested file"
                }
            }
            return contents
        }
        return String()
    #else
        return uncompressedDefinesJs
    #endif
    }
    static func DefinesJsGzip() -> Data {
        return compressedDefinesJs
    }
}

private let uncompressedDefinesJs = ###"""


"""###
private let compressedDefinesJs = Data(base64Encoded:"H4sIAAAAAAACA+MCAJMG1zIBAAAA")!

public extension Pamphlet.Private.Figurehead.Utility {
    static func LabaJs() -> String {
    #if DEBUG
        let fileOnDiskPath = "/Volumes/Development/Development/chimerasw3/PicaroonTemplate/Resources/private/figurehead/utility/laba.js"
        if let contents = try? String(contentsOf:URL(fileURLWithPath: fileOnDiskPath)) {
            if contents.hasPrefix("#define PAMPHLET_PREPROCESSOR") {
                do {
                    let task = Process()
                    task.executableURL = URL(fileURLWithPath: "/usr/local/bin/pamphlet")
                    task.arguments = ["preprocess", fileOnDiskPath]
                    let outputPipe = Pipe()
                    task.standardOutput = outputPipe
                    try task.run()
                    let outputData = outputPipe.fileHandleForReading.readDataToEndOfFile()
                    let output = String(decoding: outputData, as: UTF8.self)
                    return output
                } catch {
                    return "Failed to use /usr/local/bin/pamphlet to preprocess the requested file"
                }
            }
            return contents
        }
        return String()
    #else
        return uncompressedLabaJs
    #endif
    }
    static func LabaJsGzip() -> Data {
        return compressedLabaJs
    }
}

private let uncompressedLabaJs = ###"""
function StringBuilder(){var a=[];this.length=function(){for(var e=0,t=0;t<a.length;t++)e+=a[t].length;return e},this.setLength=function(e){let t=a.join("").substring(0,e);(a=[])[0]=t},this.insert=function(e,t){let r=a.join("");(a=[])[0]=r.substring(0,e),a[1]=t,a[2]=r.substring(e)},this.delete=function(e,t){let r=a.join("");(a=[])[0]=r.substring(0,e),a[1]=r.substring(t+1)},this.append=function(t){(t=e(t)).length>0&&(a[a.length]=t)},this.appendLine=function(t){if(t=e(t),this.isEmpty()){if(!(t.length>0))return;a[a.length]=t}else a[a.length]=t.length>0?"\r\n"+t:"\r\n"},this.clear=function(){a=[]},this.isEmpty=function(){return 0==a.length},this.toString=function(){return a.join("")};var e=function(a){return t(a)?r(a)!=r(new String)?String(a):a:""},t=function(a){return null!=a&&void 0!==a},r=function(a){if(!t(a.constructor))throw Error("Unexpected object type");var e=String(a.constructor).match(/function\s+(\w+)/);return t(e)?e[1]:"undefined"}}function easeLinear(a){return 0+1*a}function easeInQuad(a){return 0,1*a*a+0}function easeOutQuad(a){return 0,-1*a*(a-2)+0}function easeInOutQuad(a){return 0,(a/=.5)<1?.5*a*a+0:-.5*(--a*(a-2)-1)+0}function easeInCubic(a){return 0,1*a*a*a+0}function easeOutCubic(a){return 0,1*(--a*a*a+1)+0}function easeInOutCubic(a){return 0,(a/=.5)<1?.5*a*a*a+0:.5*((a-=2)*a*a+2)+0}function easeInQuart(a){return 0,1*a*a*a*a+0}function easeOutQuart(a){return 0,-1*(--a*a*a*a-1)+0}function easeInOutQuart(a){return 0,(a/=.5)<1?.5*a*a*a*a+0:-.5*((a-=2)*a*a*a-2)+0}function easeInQuint(a){return 0,1*a*a*a*a*a+0}function easeOutQuint(a){return 0,1*(--a*a*a*a*a+1)+0}function easeInOutQuint(a){return 0,(a/=.5)<1?.5*a*a*a*a*a+0:.5*((a-=2)*a*a*a*a+2)+0}function easeInSine(a){return 0,-1*Math.cos(a/1*(Math.PI/2))+1+0}function easeOutSine(a){return 0,1*Math.sin(a/1*(Math.PI/2))+0}function easeInOutSine(a){return 0,-.5*(Math.cos(Math.PI*a/1)-1)+0}function easeInExpo(a){return 0,1*Math.pow(2,10*(a/1-1))+0}function easeOutExpo(a){return 0,1*(1-Math.pow(2,-10*a/1))+0}function easeInOutExpo(a){return 0,(a/=.5)<1?.5*Math.pow(2,10*(a-1))+0:(a--,.5*(2-Math.pow(2,-10*a))+0)}function easeInCirc(a){return 0,-1*(Math.sqrt(1-a*a)-1)+0}function easeOutCirc(a){return a--,0,1*Math.sqrt(1-a*a)+0}function easeInOutCirc(a){return 0,(a/=.5)<1?-.5*(Math.sqrt(1-a*a)-1)+0:(a-=2,.5*(Math.sqrt(1-a*a)+1)+0)}function easeOutBounce(a){return a<4/11?121*a*a/16:a<8/11?9.075*a*a-9.9*a+3.4:a<.9?4356/361*a*a-35442/1805*a+16061/1805:10.8*a*a-20.52*a+10.72}function easeInBounce(a){return 1-easeOutBounce(1-a)}function easeInOutBounce(a){return a<.5?.5*easeInBounce(2*a):.5*easeOutBounce(2*a-1)+.5}function easeShake(a){return(Math.sin(3.14*a*6+.785)-.5)*(1-a)}String.prototype.format=function(){for(k in a=this,arguments)a=a.replace("{"+k+"}",arguments[k]);return a},Math.radians=function(a){return a*Math.PI/180},Math.degrees=function(a){return 180*a/Math.PI};var _allLabalTimers=[];class _LabaTimer{update(){var a=(performance.now()-this.startTime)/(this.endTime-this.startTime);if(this.endTime==this.startTime&&(a=1),a>=1&&(a=1),null!=this.onUpdate){var e=this.action.easing;null==e&&(e=easeInOutQuad),this.onUpdate(this.view,e(a))}if(a>=1)return this.action(a,!1),-1==this.loopCount?(this.action(0,!0),this.startTime=performance.now(),this.endTime=this.startTime+1e3*this.duration,void this.view.labaCommitElemVars()):this.loopCount>1?(this.loopCount--,this.action(0,!0),this.startTime=performance.now(),this.endTime=this.startTime+1e3*this.duration,void this.view.labaCommitElemVars()):(removeOne(_allLabalTimers,this),null!=this.onComplete&&this.onComplete(this.view),void this.view.labaCommitElemVars());this.action(a,!1),this.view.labaCommitElemVars()}constructor(a,e,t,r,n,i,o,s){this.view=a,this.loopCount=s,this.action=e,this.duration=n,this.onComplete=o,this.onUpdate=i,this.startTime=performance.now(),this.endTime=this.startTime+1e3*this.duration,this.action(0,!0),_allLabalTimers.push(this),this.update(0)}}class _LabaAction{constructor(a,e,t,r,n,i,o){this.operatorChar=e,this.elem=t,this.inverse=r,this.rawValue=n,this.easing=i,this.easingName=o,this.action=a.PerformActions[e],this._describe=a.DescribeActions[e],this._init=a.InitActions[e],0==this.inverse?(this.fromValue=0,this.toValue=1):(this.fromValue=1,this.toValue=0),null!=this._init&&this._init(this)}reset(a){if(null!=this._init){var e=new _LabaAction(a,this.operatorChar,this.elem,this.inverse,this.rawValue,this.easing,this.easingName);return this.fromValue=e.fromValue,this.toValue=e.toValue,!0}return!1}perform(a){return null!=this.action&&(this.action(this.elem,this.fromValue+(this.toValue-this.fromValue)*this.easing(a),this),!0)}describe(a){return null!=this._describe&&(this._describe(a,this),!0)}}class _Laba{isOperator(a){return","==a||"|"==a||"!"==a||"e"==a||a in this.InitActions}isNumber(a){return"+"==a||"-"==a||"0"==a||"1"==a||"2"==a||"3"==a||"4"==a||"5"==a||"6"==a||"7"==a||"8"==a||"9"==a||"."==a}update(){for(var a in _allLabalTimers)_allLabalTimers[a].update()}parseAnimationString(a,e){for(var t=0,r=0,n=0,i=this.allEasings[3],o=this.allEasingsByName[3],s=[],l=0;l<this.kMaxPipes;l++){s[l]=[];for(var u=0;u<this.kMaxActions;u++)s[l][u]=void 0}for(;t<e.length;){for(var m=!1,f=" ";t<e.length;){var c=e[t];if(this.isOperator(c))if("!"==c)m=!0;else if("|"==c)r++,n=0;else{if(","!=c){f=c,t++;break}0!=n&&(r++,n=0),s[r][n]=new _LabaAction(this,"d",a,!1,.26*this.kDefaultDuration,i,o),r++,n=0}t++}for(;t<e.length&&!this.isNumber(e[t])&&!this.isOperator(e[t]);)t++;var h=this.LabaDefaultValue;if(t<e.length&&this.isNumber(e[t])){var p=!1;"+"==e[t]?t++:"-"==e[t]&&(p=!0,t++),h=0;for(var V=!1,b=10;t<e.length;){c=e[t];if(this.isNumber(c)&&(c>="0"&&c<="9"&&(V?(h+=(c-"0")/b,b*=10):h=10*h+(c-"0")),"."==c&&(V=!0)),this.isOperator(c))break;t++}p&&(h*=-1)}if(" "!=f)if(f in this.InitActions)s[r][n]=new _LabaAction(this,f,a,m,h,i,o),n++;else if("e"==f){var w=h;w>=0&&t<this.allEasings.length&&(i=this.allEasings[w],o=this.allEasingsByName[w])}}return s}animateOne(a,e,t,r){for(var n=this,i=this.parseAnimationString(a,e),o=this.PerformActions.d,s=this.PerformActions.D,l=this.PerformActions.L,u=this.PerformActions.l,m=0,f=0,c=1,h=!1,p=0;p<this.kMaxPipes;p++)if(null!=i[p][0]){m++;for(var V=this.kDefaultDuration,b=0;b<this.kMaxActions;b++)null!=i[p][b]&&(i[p][b].action!=o&&i[p][b].action!=s||(V=i[p][b].fromValue),i[p][b].action==l&&(c=i[p][b].fromValue),i[p][b].action==u&&(h=!0,c=i[p][b].fromValue));f+=V}if(1==m)if(h)new _LabaTimer(a,(function(a,e){if(1==e)for(var t=0;t<n.kMaxActions&&(null==i[0][t]||i[0][t].reset(n));t++);for(var r=0;r<n.kMaxActions&&(null==i[0][r]||i[0][r].perform(a));r++);}),0,1,f,t,r,c);else{for(b=0;b<n.kMaxActions&&(null==i[0][b]||i[0][b].reset(n));b++);new _LabaTimer(a,(function(a,e){for(var t=0;t<n.kMaxActions&&(null==i[0][t]||i[0][t].perform(a));t++);}),0,1,f*n.kTimeScale,t,r,c)}else{for(var w=void 0,d=m-1;d>=0;d--){V=this.kDefaultDuration;var v=1,g=!1;for(b=0;b<this.kMaxActions;b++)null!=i[d][b]&&(i[d][b].action!=o&&i[d][b].action!=s||(V=i[d][b].fromValue),i[d][b].action==l&&(v=i[d][b].fromValue),i[d][b].action==u&&(g=!0,v=i[d][b].fromValue));let e=d;var T=w;null==T&&(T=r),null==T&&(T=function(){});let m=g,f=V,c=v,h=T;w=function(){if(m)new _LabaTimer(a,(function(a,t){if(1==t)for(var r=0;r<n.kMaxActions&&(null==i[e][r]||i[e][r].reset(n));r++);for(r=0;r<n.kMaxActions&&(null==i[e][r]||i[e][r].perform(a));r++);}),0,1,f,t,h,c);else{for(var r=0;r<n.kMaxActions&&(null==i[e][r]||i[e][r].reset(n));r++);new _LabaTimer(a,(function(a,t){for(var r=0;r<n.kMaxActions&&(null==i[e][r]||i[e][r].perform(a));r++);}),0,1,f*n.kTimeScale,t,h,c)}}}null!=w?w():null!=r&&r(this.view)}}reset(a){if(null==a.labaTransformX){var e=a;e.labaResetElemVars=function(){e.labaTransformX=0,e.labaTransformY=0,e.labaTransformZ=0,e.labaRotationX=0,e.labaRotationY=0,e.labaRotationZ=0,e.labaScale=1,null!=e.style&&(e.labaAlpha=parseFloat(e.style.opacity)),isNaN(e.labaAlpha)&&(e.labaAlpha=1)},e.labaCommitElemVars=function(){if(null!=e.position&&(e.position.set(e.labaTransformX,e.labaTransformY),e.scale.set(e.labaScale,e.labaScale),e.rotation=e.labaRotationZ,e.alpha=e.labaAlpha),null!=e.style){var a=Matrix.identity();a=Matrix.multiply(a,Matrix.translate(e.labaTransformX,e.labaTransformY,e.labaTransformZ)),a=Matrix.multiply(a,Matrix.rotateX(Math.radians(e.labaRotationX))),a=Matrix.multiply(a,Matrix.rotateY(Math.radians(e.labaRotationY))),a=Matrix.multiply(a,Matrix.rotateZ(Math.radians(e.labaRotationZ))),a=Matrix.multiply(a,Matrix.scale(e.labaScale,e.labaScale,e.labaScale));let t="perspective(500px) matrix3d({0},{1},{2},{3},{4},{5},{6},{7},{8},{9},{10},{11},{12},{13},{14},{15})".format(a.m00,a.m10,a.m20,a.m30,a.m01,a.m11,a.m21,a.m31,a.m02,a.m12,a.m22,a.m32,a.m03,a.m13,a.m23,a.m33);e.style.webkitTransform=t,e.style.MozTransform=t,e.style.msTransform=t,e.style.OTransform=t,e.style.transform=t,e.style.opacity=e.labaAlpha}}}a.labaResetElemVars(),null==a.style&&null!=a.position&&(a.labaTransformX=a.position.x,a.labaTransformY=a.position.y,a.labaRotationZ=a.rotation,a.labaScale=a.scale.x,a.labaAlpha=a.alpha)}set(a,e,t,r,n,i,o,s,l){this.reset(a),a.labaTransformX=e,a.labaTransformY=t,a.labaTransformZ=r,a.labaRotationX=n,a.labaRotationY=i,a.labaRotationZ=o,a.labaScale=s,a.labaAlpha=l,a.labaCommitElemVars()}animate(a,e,t,r){if(null==a.labaTransformX&&this.reset(a),e.includes("["))for(var n=e.replace("["," ").split("]"),i=0;i<n.length;i++){var o=n[i];o.length>0&&(this.animateOne(a,o,t,r),r=void 0)}else this.animateOne(a,e,t,r),r=void 0}cancel(a){for(var e in _allLabalTimers)_allLabalTimers[e].view==a&&removeOne(_allLabalTimers,_allLabalTimers[e])}describeOne(a,e,t){for(var r=this.parseAnimationString(a,e),n=this.PerformActions.d,i=this.PerformActions.D,o=this.PerformActions.L,s=this.PerformActions.l,l=0,u=0,m=1,f="absolute",c=0;c<this.kMaxPipes;c++)if(null!=r[c][0]){l++;for(var h=this.kDefaultDuration,p=0;p<this.kMaxActions;p++)null!=r[c][p]&&(r[c][p].action!=n&&r[c][p].action!=i||(h=r[c][p].fromValue),r[c][p].action==o&&(m=r[c][p].fromValue),r[c][p].action==s&&(m=r[c][p].fromValue,f="relative"));u+=h}if(1==l){var V=t.length();for(c=0;c<this.kMaxActions&&(null==r[0][c]||r[0][c].describe(t));c++);m>1?t.append(" {0} repeating {1} times, ".format(f,m)):-1==m&&t.append(" {0} repeating forever, ".format(f)),V!=t.length()?(t.append(" {0}  ".format(r[0][0].easingName)),t.setLength(t.length()-2),0==u?t.append(" instantly."):t.append(" over {0} seconds.".format(u*this.kTimeScale))):(t.length()>2&&t.setLength(t.length()-2),t.append(" wait for {0} seconds.".format(u*this.kTimeScale)))}else for(var b=0;b<l;b++){V=t.length(),h=this.kDefaultDuration;var w=1,d="absolute";for(p=0;p<this.kMaxActions;p++)null!=r[b][p]&&(r[b][p].action!=n&&r[b][p].action!=i||(h=r[b][p].fromValue),r[b][p].action==o&&(w=r[b][p].fromValue),r[b][p].action==s&&(w=r[b][p].fromValue,d="relative"));var v=b;for(p=0;p<this.kMaxActions&&(null==r[v][p]||r[v][p].reset(this));p++);for(p=0;p<this.kMaxActions&&(null==r[v][p]||r[v][p].describe(t));p++);w>1?t.append(" {0} repeating {1} times, ".format(d,w)):-1==w&&t.append(" {0} repeating forever, ".format(d)),V!=t.length()?(t.append(" {0}  ".format(r[v][0].easingName)),t.setLength(t.length()-2),0==h?t.append(" instantly."):t.append(" over {0} seconds.".format(h*this.kTimeScale))):t.append(" wait for {0} seconds.".format(h*this.kTimeScale)),b+1<l&&t.append(" Once complete then  ")}}describe(a,e){if(null==e||0==e.length)return"do nothing";var t=new StringBuilder;if(e.includes("[")){var r=e.replace("["," ").split("]"),n=0;t.append("Perform a series of animations at the same time.\n");for(var i=0;i<r.length;i++){var o=r[i];o.length>0&&(t.append("Animation #{0} will ".format(n+1)),this.describeOne(a,o,t),t.append("\n"),n++)}}else this.describeOne(a,e,t);return t.length()>0&&(t.insert(0,t.toString().substring(0,1).toUpperCase()),t.delete(1,1)),t.toString()}registerOperation(a,e,t,r){this.InitActions[a]=e,this.PerformActions[a]=t,this.DescribeActions[a]=r}constructor(){this.allEasings=[easeLinear,easeInQuad,easeOutQuad,easeInOutQuad,easeInCubic,easeOutCubic,easeInOutCubic,easeInQuart,easeOutQuart,easeInOutQuart,easeInQuint,easeOutQuint,easeInOutQuint,easeInSine,easeOutSine,easeInOutSine,easeInExpo,easeOutExpo,easeInOutExpo,easeInCirc,easeOutCirc,easeInOutCirc,easeInBounce,easeOutBounce,easeInOutBounce,easeShake],this.allEasingsByName=["ease linear","ease out quad","ease in quad","ease in/out quad","ease in cubic","ease out cubic","ease in/out cubic","ease in quart","ease out quart","ease in/out quart","ease in quint","ease out quint","ease in/out quint","ease in sine","eas out sine","ease in/out sine","ease in expo","ease out expo","ease in out expo","ease in circ","ease out circ","ease in/out circ","ease in bounce","ease out bounce","ease in/out bounce","ease shake"],this.LabaDefaultValue=Number.MIN_VALUE,this.InitActions={},this.PerformActions={},this.DescribeActions={},this.kMaxPipes=40,this.kMaxActions=40,this.kDefaultDuration=.57,this.kTimeScale=1;let a=this.LabaDefaultValue,e=this.kDefaultDuration;this.registerOperation("L",(function(e){return e.rawValue==a&&(e.rawValue=-1),e.fromValue=e.toValue=e.rawValue,e}),(function(a,e,t){}),(function(a,e){})),this.registerOperation("l",(function(e){return e.rawValue==a&&(e.rawValue=-1),e.fromValue=e.toValue=e.rawValue,e}),(function(a,e,t){}),(function(a,e){})),this.registerOperation("d",(function(t){return t.rawValue==a&&(t.rawValue=e),t.fromValue=t.toValue=t.rawValue,t}),(function(a,e,t){}),(function(a,e){})),this.registerOperation("D",(function(t){t.rawValue==a&&(t.rawValue=e);for(var r=0,n=t.elem;null!=(n=n.previousSibling);)r++;return t.fromValue=t.toValue=t.rawValue*r,t}),(function(a,e,t){}),(function(a,e){})),this.registerOperation("x",(function(e){return e.rawValue==a&&(e.rawValue=0),e.inverse?(e.fromValue=e.rawValue,e.toValue=e.elem.labaTransformX):(e.fromValue=e.elem.labaTransformX,e.toValue=e.rawValue),e}),(function(a,e,t){a.labaTransformX=e}),(function(a,e){e.inverse?a.append("move from {0} x pos, ".format(e.rawValue)):a.append("move to {0} x pos, ".format(e.rawValue))})),this.registerOperation("y",(function(e){return e.rawValue==a&&(e.rawValue=0),e.inverse?(e.fromValue=e.rawValue,e.toValue=e.elem.labaTransformY):(e.fromValue=e.elem.labaTransformY,e.toValue=e.rawValue),e}),(function(a,e,t){a.labaTransformY=e}),(function(a,e){e.inverse?a.append("move from {0} y pos, ".format(e.rawValue)):a.append("move to {0} y pos, ".format(e.rawValue))})),this.registerOperation("z",(function(e){return e.rawValue==a&&(e.rawValue=0),e.inverse?(e.fromValue=e.rawValue,e.toValue=e.elem.labaTransformZ):(e.fromValue=e.elem.labaTransformZ,e.toValue=e.rawValue),e}),(function(a,e,t){a.labaTransformZ=e}),(function(a,e){e.inverse?a.append("move from {0} z pos, ".format(e.rawValue)):a.append("move to {0} z pos, ".format(e.rawValue))})),this.registerOperation("<",(function(e){return e.rawValue==a&&(e.rawValue=e.elem.offsetWidth),e.inverse?(e.fromValue=e.elem.labaTransformX+e.rawValue,e.toValue=e.elem.labaTransformX):(e.fromValue=e.elem.labaTransformX,e.toValue=e.elem.labaTransformX-e.rawValue),e}),(function(a,e,t){a.labaTransformX=e}),(function(a,e){e.inverse?a.append("move in from right {0} units, ".format(e.rawValue)):a.append("move left {0} units, ".format(e.rawValue))})),this.registerOperation(">",(function(e){return e.rawValue==a&&(e.rawValue=e.elem.offsetWidth),e.inverse?(e.fromValue=e.elem.labaTransformX-e.rawValue,e.toValue=e.elem.labaTransformX):(e.fromValue=e.elem.labaTransformX,e.toValue=e.elem.labaTransformX+e.rawValue),e}),(function(a,e,t){a.labaTransformX=e}),(function(a,e){e.inverse?a.append("move in from left {0} units, ".format(e.rawValue)):a.append("move right {0} units, ".format(e.rawValue))})),this.registerOperation("^",(function(e){return e.rawValue==a&&(e.rawValue=e.elem.offsetHeight),e.inverse?(e.fromValue=e.elem.labaTransformY+e.rawValue,e.toValue=e.elem.labaTransformY):(e.fromValue=e.elem.labaTransformY,e.toValue=e.elem.labaTransformY-e.rawValue),e}),(function(a,e,t){a.labaTransformY=e}),(function(a,e){e.inverse?a.append("move in from below {0} units, ".format(e.rawValue)):a.append("move up {0} units, ".format(e.rawValue))})),this.registerOperation("v",(function(e){return e.rawValue==a&&(e.rawValue=e.elem.offsetHeight),e.inverse?(e.fromValue=e.elem.labaTransformY-e.rawValue,e.toValue=e.elem.labaTransformY):(e.fromValue=e.elem.labaTransformY,e.toValue=e.elem.labaTransformY+e.rawValue),e}),(function(a,e,t){a.labaTransformY=e}),(function(a,e){e.inverse?a.append("move in from above {0} units, ".format(e.rawValue)):a.append("move down {0} units, ".format(e.rawValue))})),this.registerOperation("s",(function(e){return e.rawValue==a&&(e.rawValue=1),e.inverse?(e.fromValue=e.rawValue>.5?0:1,e.toValue=e.rawValue):(e.fromValue=e.elem.labaScale,e.toValue=e.rawValue),e}),(function(a,e,t){a.labaScale=e}),(function(a,e){e.inverse?a.append("scale in from {0}%, ".format(100*e.rawValue)):a.append("scale to {0}%, ".format(100*e.rawValue))})),this.registerOperation("r",(function(e){return e.rawValue==a&&(e.rawValue=0),e.inverse?(e.fromValue=e.elem.labaRotationZ+e.rawValue,e.toValue=e.elem.labaRotationZ):(e.fromValue=e.elem.labaRotationZ,e.toValue=e.elem.labaRotationZ-e.rawValue),e}),(function(a,e,t){a.labaRotationZ=e}),(function(a,e){e.inverse?a.append("rotate in from around z by {0}, ".format(e.rawValue)):a.append("rotate around z by {0}, ".format(e.rawValue))})),this.registerOperation("p",(function(e){return e.rawValue==a&&(e.rawValue=0),e.inverse?(e.fromValue=e.elem.labaRotationX+e.rawValue,e.toValue=e.elem.labaRotationX):(e.fromValue=e.elem.labaRotationX,e.toValue=e.elem.labaRotationX-e.rawValue),e}),(function(a,e,t){a.labaRotationX=e}),(function(a,e){e.inverse?a.append("rotate in from around x by {0}, ".format(e.rawValue)):a.append("rotate around x by {0}, ".format(e.rawValue))})),this.registerOperation("w",(function(e){return e.rawValue==a&&(e.rawValue=0),e.inverse?(e.fromValue=e.elem.labaRotationY+e.rawValue,e.toValue=e.elem.labaRotationY):(e.fromValue=e.elem.labaRotationY,e.toValue=e.elem.labaRotationY-e.rawValue),e}),(function(a,e,t){a.labaRotationY=e}),(function(a,e){e.inverse?a.append("rotate in from around y by {0}, ".format(e.rawValue)):a.append("rotate around y by {0}, ".format(e.rawValue))})),this.registerOperation("f",(function(e){return e.rawValue==a&&(e.rawValue=1),e.inverse?(e.fromValue=e.rawValue>.5?0:1,e.toValue=e.rawValue):(e.fromValue=e.elem.labaAlpha,e.toValue=e.rawValue),e}),(function(a,e,t){a.labaAlpha=e}),(function(a,e){e.inverse?a.append("fade from {0}% to {1}%, ".format(100*e.fromValue,100*e.toValue)):a.append("fade to {0}%, ".format(100*e.rawValue))}))}}var Laba=new _Laba;class Matrix{constructor(a,e,t,r,n,i,o,s,l,u,m,f,c,h,p,V){this.m00=a,this.m01=e,this.m02=t,this.m03=r,this.m10=n,this.m11=i,this.m12=o,this.m13=s,this.m20=l,this.m21=u,this.m22=m,this.m23=f,this.m30=c,this.m31=h,this.m32=p,this.m33=V}static identity(){return new Matrix(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}static translate(a,e,t){return new Matrix(1,0,0,a,0,1,0,e,0,0,1,t,0,0,0,1)}static scale(a,e,t){return new Matrix(a,0,0,0,0,e,0,0,0,0,t,0,0,0,0,1)}static rotateX(a){let e=Math.sin(a),t=Math.cos(a);return new Matrix(1,0,0,0,0,t,-e,0,0,e,t,0,0,0,0,1)}static rotateY(a){let e=Math.sin(a),t=Math.cos(a);return new Matrix(t,0,e,0,0,1,0,0,-e,0,t,0,0,0,0,1)}static rotateZ(a){let e=Math.sin(a),t=Math.cos(a);return new Matrix(t,-e,0,0,e,t,0,0,0,0,1,0,0,0,0,1)}static ortho(a,e,t,r,n,i){return new Matrix(2/(e-a),0,0,-(e+a)/(e-a),0,2/(r-t),0,-(r+t)/(r-t),0,0,-2/(i-n),-(i+n)/(i-n),0,0,0,1)}static ortho2d(a,e,t,r){return new Matrix.ortho(a,e,t,r,-1,1)}static frustrum(a,e,t,r,n,i){return new Matrix(2*n/(e-a),0,(e+a)/(e-a),0,0,2*n/(r-t),(r+t)/(r-t),0,0,0,-(i+n)/(i-n),-2*i*n/(i-n),0,0,-1,0)}static perspective(a,e,t,r){let n=t*tan(a*Float.pi/360),i=-n;return m4_frustrum(i*e,n*e,i,n,t,r)}static multiply(a,e){var t=Matrix.identity();return t.m00=a.m00*e.m00+a.m01*e.m10+a.m02*e.m20+a.m03*e.m30,t.m10=a.m10*e.m00+a.m11*e.m10+a.m12*e.m20+a.m13*e.m30,t.m20=a.m20*e.m00+a.m21*e.m10+a.m22*e.m20+a.m23*e.m30,t.m30=a.m30*e.m00+a.m31*e.m10+a.m32*e.m20+a.m33*e.m30,t.m01=a.m00*e.m01+a.m01*e.m11+a.m02*e.m21+a.m03*e.m31,t.m11=a.m10*e.m01+a.m11*e.m11+a.m12*e.m21+a.m13*e.m31,t.m21=a.m20*e.m01+a.m21*e.m11+a.m22*e.m21+a.m23*e.m31,t.m31=a.m30*e.m01+a.m31*e.m11+a.m32*e.m21+a.m33*e.m31,t.m02=a.m00*e.m02+a.m01*e.m12+a.m02*e.m22+a.m03*e.m32,t.m12=a.m10*e.m02+a.m11*e.m12+a.m12*e.m22+a.m13*e.m32,t.m22=a.m20*e.m02+a.m21*e.m12+a.m22*e.m22+a.m23*e.m32,t.m32=a.m30*e.m02+a.m31*e.m12+a.m32*e.m22+a.m33*e.m32,t.m03=a.m00*e.m03+a.m01*e.m13+a.m02*e.m23+a.m03*e.m33,t.m13=a.m10*e.m03+a.m11*e.m13+a.m12*e.m23+a.m13*e.m33,t.m23=a.m20*e.m03+a.m21*e.m13+a.m22*e.m23+a.m23*e.m33,t.m33=a.m30*e.m03+a.m31*e.m13+a.m32*e.m23+a.m33*e.m33,t}}

"""###
private let compressedLabaJs = Data(base64Encoded:"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")!

public extension Pamphlet.Private.Figurehead.Utility {
    static func NavigationJs() -> String {
    #if DEBUG
        let fileOnDiskPath = "/Volumes/Development/Development/chimerasw3/PicaroonTemplate/Resources/private/figurehead/utility/navigation.js"
        if let contents = try? String(contentsOf:URL(fileURLWithPath: fileOnDiskPath)) {
            if contents.hasPrefix("#define PAMPHLET_PREPROCESSOR") {
                do {
                    let task = Process()
                    task.executableURL = URL(fileURLWithPath: "/usr/local/bin/pamphlet")
                    task.arguments = ["preprocess", fileOnDiskPath]
                    let outputPipe = Pipe()
                    task.standardOutput = outputPipe
                    try task.run()
                    let outputData = outputPipe.fileHandleForReading.readDataToEndOfFile()
                    let output = String(decoding: outputData, as: UTF8.self)
                    return output
                } catch {
                    return "Failed to use /usr/local/bin/pamphlet to preprocess the requested file"
                }
            }
            return contents
        }
        return String()
    #else
        return uncompressedNavigationJs
    #endif
    }
    static func NavigationJsGzip() -> Data {
        return compressedNavigationJs
    }
}

private let uncompressedNavigationJs = ###"""
function sendIfModified(e,t,s,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){4==this.readyState&&(503==this.status?window.location.href="./":(200!=this.status&&(null!=this.responseText&&this.responseText.length>0||this.statusText),null!=n&&n(this)))},i.open("POST","./");let o=sessionStorage.getItem("Session-Id");null!=o&&i.setRequestHeader("Session-Id",o),i.setRequestHeader("Flynn-Tag","hotload"),i.setRequestHeader("Pragma","no-cache"),i.setRequestHeader("Expires","-1"),i.setRequestHeader("Cache-Control","no-cache"),null!=t&&i.setRequestHeader("If-Modified-Since",t),e instanceof FormData?i.send(e):(i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.send(JSON.stringify(e)))}function send(e,t){return sendIfModified(e,void 0,!1,t)}function endSession(e){send({endUserSession:!0},(function(){e()}))}

"""###
private let compressedNavigationJs = Data(base64Encoded:"H4sIAAAAAAACA3WST2+bQBDF7/0UmANipYWQ/pEqWzSHtFZcNU1UiNTrCgbYCs/S3SGORfzdM8REdVRyQWL2997OzL6qx4K0Qc8Blpvq2pS60lCGIEk6iWK4V9bTKcLO+33944qo+wV/e3C00rFBC6rcO1IERaOwhrSa7EIxfExTarSLn5lsZIIg/JR8mMqjqncXO42l2cWtKdSoixsLVerHZ/4yfJ8ki1OW5di37eLF1nUGHeTwQEHwXyluAWtqviSPjycW44mQRxcMAgzHMyHEQfI0HWDo395kuS/HBsSqBfJM6sA57iwjY1UNcQ20IdiGfnasR5uS0aOlCQIdO6BpRVc8OdhXpDRCziHrdo8Y5armuxtDrVHsOkvechdbxRiaqFBFA29w3x46zQthMDp/A7kc5dGlQbKmfe04LXp+nk0VveQkyjQW4EveKngaecv8aypvbez2qyJ1MeqR4ySW4WwLfDkgRfm+YxdfdV2rj0k4++MMrjhWllXpXb6OPk9jsN337OYnP6nVWOtqz+78hNVpksf8isEC9XYm2vdGl14iF+cM/dMxNb0UGw7PLgN/7hzYqb5cJAcZnmQcQnHgq989AeNqiA5GAwAA")!

public extension Pamphlet.Private.Figurehead.Utility {
    static func TimerJs() -> String {
    #if DEBUG
        let fileOnDiskPath = "/Volumes/Development/Development/chimerasw3/PicaroonTemplate/Resources/private/figurehead/utility/timer.js"
        if let contents = try? String(contentsOf:URL(fileURLWithPath: fileOnDiskPath)) {
            if contents.hasPrefix("#define PAMPHLET_PREPROCESSOR") {
                do {
                    let task = Process()
                    task.executableURL = URL(fileURLWithPath: "/usr/local/bin/pamphlet")
                    task.arguments = ["preprocess", fileOnDiskPath]
                    let outputPipe = Pipe()
                    task.standardOutput = outputPipe
                    try task.run()
                    let outputData = outputPipe.fileHandleForReading.readDataToEndOfFile()
                    let output = String(decoding: outputData, as: UTF8.self)
                    return output
                } catch {
                    return "Failed to use /usr/local/bin/pamphlet to preprocess the requested file"
                }
            }
            return contents
        }
        return String()
    #else
        return uncompressedTimerJs
    #endif
    }
    static func TimerJsGzip() -> Data {
        return compressedTimerJs
    }
}

private let uncompressedTimerJs = ###"""
let globalTimers=[];function initTimers(){setInterval(callTimers,250)}function callTimers(){for(let l,e=null!=globalTimers?globalTimers:[],r=0;l=e[r],r<e.length;r++)l.counter-=250,l.counter<=0&&(l.counter=l.delay,l.callback())}function addTimer(l,e){globalTimers.push({callback:e,delay:l,counter:l})}function clearTimer(l){for(let e,r=null!=globalTimers?globalTimers:[],a=0;e=r[a],a<r.length;a++)e.callback==l&&removeOne(globalTimers,e)}function clearAllTimer(){globalTimers=[]}

"""###
private let compressedTimerJs = Data(base64Encoded:"H4sIAAAAAAACA42RQU/DMAyF7/yKcakSLVQVEpe2FuLIiQu3agev9bYKL0VuOglV/e94o+sCJ252Yr/3voQprPbcbZHf2yNJD9Wm2A2+Dm3nV61vw8+xsWNP4dUHkhOyqZHneff4lNlp2bhd6MauE8Oqz47AD8z3EDs9x01ebZxAVjBQJVqWlDL5fTgUsl5bTutuOHs/gNq5pS0hSxKztMBpQ4xf5wHNscX6w9goHDbNxc1oIDvG9unn0B/MeN3KyV2EcnazdM5TTMmEMkvdMEkJ/oGJikkgFWpZyhUTFZOW2ACcJELH7kRvnkwsodH/BHmZn9z8ZtKfnO6+AdnfHBffAQAA")!

public extension Pamphlet.Private.Figurehead.Utility {
    static func UtilityJs() -> String {
    #if DEBUG
        let fileOnDiskPath = "/Volumes/Development/Development/chimerasw3/PicaroonTemplate/Resources/private/figurehead/utility/utility.js"
        if let contents = try? String(contentsOf:URL(fileURLWithPath: fileOnDiskPath)) {
            if contents.hasPrefix("#define PAMPHLET_PREPROCESSOR") {
                do {
                    let task = Process()
                    task.executableURL = URL(fileURLWithPath: "/usr/local/bin/pamphlet")
                    task.arguments = ["preprocess", fileOnDiskPath]
                    let outputPipe = Pipe()
                    task.standardOutput = outputPipe
                    try task.run()
                    let outputData = outputPipe.fileHandleForReading.readDataToEndOfFile()
                    let output = String(decoding: outputData, as: UTF8.self)
                    return output
                } catch {
                    return "Failed to use /usr/local/bin/pamphlet to preprocess the requested file"
                }
            }
            return contents
        }
        return String()
    #else
        return uncompressedUtilityJs
    #endif
    }
    static func UtilityJsGzip() -> Data {
        return compressedUtilityJs
    }
}

private let uncompressedUtilityJs = ###"""
function isDarkMode(){return!(!window.matchMedia||!window.matchMedia("(prefers-color-scheme: dark)").matches)}function watchDarkMode(e){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(n=>{e(n.matches)}))}function print(e){console.log(e)}function hide(e){e.style.display="none"}function show(e){e.style.display="flex"}function hashCode(e){return e.split("").reduce((function(e,n){return(e=(e<<5)-e+n.charCodeAt(0))&e}),0)}function onRangeChange(e,n){var t,r,i;e.addEventListener("input",(function(e){t=1,(r=e.target.value)!=i&&n(e),i=r})),e.addEventListener("change",(function(e){t||n(e)}))}function rad2Deg(e){return e*(180/Math.PI)}function deg2Rad(e){return e*(Math.PI/180)}function rand01(){return Math.random()}function randSign(){return Math.random()<.5?-1:1}function randomFromArray(e){return e[Math.floor(Math.random()*e.length)]}function getChild(e,n){return e.getElementById(n)}function insertAt(e,n,t){e.splice(n,0,t)}function removeAt(e,n){return e.splice(n,1),e}function removeOne(e,n){var t=e.indexOf(n);return t>-1&&e.splice(t,1),e}function removeAll(e,n){for(var t=0;t<e.length;)e[t]===n?e.splice(t,1):++t;return e}function removeAllChildren(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function removeFromParent(e){e.parentElement&&e.parentElement.removeChild(e)}function disableDiv(e){e.style.opacity=.5,e.style.pointerEvents="none"}function enableDiv(e){e.style.opacity=1,e.style.pointerEvents="auto"}function replaceHtml(e,n){e.innerHTML=n,runAllScriptsIn(e)}function insertHtml(e,n){let t=e.children.length;e.insertAdjacentHTML("beforeend",n);for(var r=t;r<e.children.length;r++)runAllScriptsIn(e.children[r]);return e.children[t]}function runAllScriptsIn(div){"text/javascript"==div.type&&eval(div.innerHTML);var scripts=Array.from(div.getElementsByTagName("script"));for(let _arr=null!=scripts?scripts:[],_idx=0,child;child=_arr[_idx],_idx<_arr.length;_idx++)null!=child.type&&"text/javascript"!=child.type||eval(child.innerHTML)}function prettyDate(e,n=!0){if(0==n)return new Date(e).toLocaleDateString("en-US");let t=(new Date-new Date(e))/1e3,r=Math.floor(t/86400);return isNaN(r)||r<0||r>=31?new Date(e).toLocaleDateString("en-US"):0==r&&((t<60?"just now":t<120&&"1 minute ago")||t<3600&&Math.floor(t/60)+" minutes ago"||t<7200&&"1 hour ago"||t<86400&&Math.floor(t/3600)+" hours ago")||1==r&&"Yesterday"||r<7&&r+" days ago"||r<31&&Math.ceil(r/7)+" weeks ago"}function lerp(e,n,t){return e*(1-t)+n*t}function clamp(e,n,t){return e<=n?n:e>=t?t:e}function clamp01(e){return e<=0?0:e>=1?1:e}function parseVec(e){if(null==e)return{x:0,y:0};var n=e.split(",");return{x:parseFloat(n[0]),y:parseFloat(n[1])}}function distanceSq(e,n){return(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)}function allElementsFromPoint(e,n){for(var t,r=[],i=[];(t=document.elementFromPoint(e,n))&&t!==document.documentElement;)r.push(t),i.push(t.style.visibility),t.style.visibility="hidden";for(var o=0;o<r.length;o++)r[o].style.visibility=i[o];return r.reverse(),r}function textFieldOnReturn(e,n){e.addEventListener("keyup",(function(e){13===e.keyCode&&(e.preventDefault(),n())}))}function textFieldOnChange(e,n){e.addEventListener("keyup",(function(t){clearTimeout(e.searchTimeout),13===t.keyCode?(t.preventDefault(),n()):e.searchTimeout=setTimeout((function(){n()}),650)}))}function textFieldOnEnter(e,n){e.addEventListener("keyup",(function(e){13===e.keyCode&&(e.preventDefault(),n())}))}function UUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)}))}function UNIQUEID(){return"bxxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=16*Math.random()|0;return("x"==e?n:3&n|8).toString(16)}))}function stripHtml(e){print(e);let n=(new DOMParser).parseFromString(e,"text/html");return print(n.body.textContent),n.body.textContent||""}function unstripHtml(e){return e.replace("&lt;","<")}function clone(e){return JSON.parse(JSON.stringify(e))}function isSmallScreen(){return window.innerWidth<window.innerHeight||window.innerWidth<900}

"""###
private let compressedUtilityJs = Data(base64Encoded:"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")!

